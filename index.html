<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <canvas id="canvas" style="border: 3px solid red;" height="600" width="300"> </canvas>
    <script>
      //allow stacking of boxes

      const canvas = document.getElementById('canvas')
      const ctx = canvas.getContext('2d')
      var xShift = 0;
      var currentCol = 0;
      var currentRow = 0;
      //in block positions, xPos key points to an array of yPos's
      const blockPositions = {0: [25], 1: [25],  2: [25], 3: [25], 4: [25], 5: [25], 6: [25], 7: [25], 8: [25], 9:[25], 10: [25]};
      sinkBlocks = (delay, col,  row) => {


        var bottom = canvas.height
        currentCol = col
        currentRow = row;
        var xPos = (col + xShift) * 25
        var yPos = (row) * 25
        console.log(col)
        if (blockPositions[col + xShift].slice(-1)[0] === row + 1) {
            blockPositions[col + xShift].push(row)
            xShift = 0;
            return sinkBlocks(300, Math.floor(Math.random() * 11), 0)
        };
        if (xShift >= 0) {
          for (i=0; i < xShift + 1; i++) {
            ctx.clearRect((currentCol + i) * 25, 0, 25, row * 25)
          }
        } else {
          for (i=0; -i > xShift - 1; i++) {
            ctx.clearRect((currentCol - i) * 25, 0, 25, row * 25)
          }
        }
        ctx.clearRect((currentCol) * 25, 0 , 25, row * 25)

          ctx.beginPath();
          ctx.moveTo(xPos + 1, yPos);
          ctx.lineTo(xPos + 1, yPos + 24);
          ctx.lineTo(xPos + 23, yPos + 24);
          ctx.lineTo(xPos + 23, yPos );
          ctx.lineTo(xPos + 1, yPos);
          ctx.stroke();
          setTimeout( () => {
            sinkBlocks(delay, col, row + 1)
          }, delay);
      }

      document.addEventListener('DOMContentLoaded', () => {
        sinkBlocks(300, 3, 0);
      })



      document.addEventListener('keypress', (e) => {
        switch(e.key) {
          case "d" :
            console.log("d pressed!")
            if ((currentCol + xShift) < 10) {xShift = xShift + 1;}
            break
          case "a" :
            console.log("a pressed!")
            if ((currentCol + xShift) > 1) {xShift = xShift - 1;}
            break
          default :
            console.log('wrong key')
        }
      })
    </script>

    <style>

    <style>
  </head>
  <body>

  </body>
</html>
